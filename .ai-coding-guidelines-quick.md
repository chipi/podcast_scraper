# AI Coding Guidelines - Quick Reference

> **‚ö†Ô∏è This is a condensed quick reference. For complete details, see `.ai-coding-guidelines.md`**

## üö® CRITICAL RULES (MUST FOLLOW - NO EXCEPTIONS)

### Commit Workflow (MANDATORY)

1. ‚ùå NEVER commit without showing `git status` first
2. ‚ùå NEVER commit without showing `git diff` first
3. ‚ùå NEVER commit without explicit user approval
4. ‚úÖ ALWAYS show changes ‚Üí wait for approval ‚Üí get commit message ‚Üí THEN commit

### PR Push Workflow (MANDATORY)

1. ‚ùå NEVER push without showing `git status` and `git diff` first
2. ‚ùå NEVER push without explicit user approval
3. ‚úÖ Show changes ‚Üí ask approval ‚Üí THEN push
4. ‚úÖ Pre-commit hook already ran `make ci-fast` checks, so no need to run `make ci` again

### File Location Rule (MANDATORY)

- ‚úÖ ALWAYS create analysis/plan documents in `docs/wip/`
- ‚ùå NEVER create `docs/analysis/` or `docs/plan/` folders

### Testing Before Commit (MANDATORY)

1. ‚úÖ Run `make ci-fast` before committing (fast validation: formatting, linting, fast tests)
2. ‚úÖ Pre-commit hook will also run `make ci-fast` checks automatically
3. ‚úÖ After pre-commit passes, push directly (no need to run `make ci` again)

### GitHub Operations (MANDATORY)

1. ‚úÖ ALWAYS use MCP GitHub server tools first for all GitHub operations
2. ‚ö†Ô∏è Fallback to GitHub API only if MCP server unavailable or fails
3. ‚ùå NEVER use GitHub API directly when MCP server is available
4. ‚úÖ Use MCP for: PRs, issues, branches, searches, reviews, comments

## üìö When to Load Full Guides

**Load on-demand when working on specific topics:**

- **Code style/formatting** ‚Üí `docs/guides/DEVELOPMENT_GUIDE.md` (Code Style section)
- **Testing implementation** ‚Üí `docs/guides/TESTING_GUIDE.md`
- **Markdown editing** ‚Üí `docs/guides/MARKDOWN_LINTING_GUIDE.md`
- **Cursor model selection** ‚Üí `docs/guides/CURSOR_AI_BEST_PRACTICES_GUIDE.md`
- **Complete reference** ‚Üí `.ai-coding-guidelines.md` (full 2,169 lines)

## Quick Commands

```bash
make test-ci-fast      # Fast tests (default)
make ci                # Full CI validation (before push)
make format            # Auto-format code
make fix-md            # Auto-fix markdown
make lint-markdown     # Check markdown
make docs              # Validate docs build (REQUIRED after docs changes)
```

## Key Patterns

- **Module boundaries**: Respect separation (no HTTP in CLI, no business logic in config)
- **Lazy loading**: Use `__getattr__` pattern for optional dependencies
- **Mock external deps**: Always mock HTTP, ML models, file I/O in unit tests
- **Config-driven**: All runtime options flow through `Config` model
- **Documentation**: Update README for CLI changes, ARCHITECTURE.md for design changes

## Decision Trees

**New feature?**

- User-facing ‚Üí Create PRD in `docs/prd/`
- Architecture change ‚Üí Create RFC in `docs/rfc/`
- Small change (<100 lines) ‚Üí Skip PRD/RFC

**Where to put test?**

- Single function, fully mocked ‚Üí `tests/unit/`
- Component interactions ‚Üí `tests/integration/`
- Complete workflow ‚Üí `tests/e2e/`

**What tests to run?**

- Any code change ‚Üí `make test-ci-fast` first
- ML model changes ‚Üí Also run slow tests
- Before push ‚Üí `make ci` (mandatory)

---

**For complete details, see `.ai-coding-guidelines.md` (2,169 lines)**
